var cookie=document.cookie.substr(document.cookie.indexOf("=")+1);var webSocket=new WebSocket("ws://"+location.hostname+":"+location.port+"/play-status");webSocket.onopen=function(a){webSocket.send("channel,"+cookie)};webSocket.onmessage=function(b){var d=JSON.parse(b.data);if(d.status){setStatus(d.status);return}var a=document.getElementById("myvideo");if(a.src!==d.url){a.src=d.url}var c=Math.abs(a.currentTime-d.seconds);if(c>1){a.currentTime=d.seconds}if(d.playing&&a.paused){a.currentTime=d.seconds;a.play()}else{if(!d.playing&&!a.paused){a.currentTime=d.seconds;a.pause()}}};webSocket.onclose=function(){setStatus("e:WebSocket closed! This is Luke's fault. Try refreshing the page.")};function setStatus(b){var a=document.querySelector("#snackbar");if(b.length==0){a.MaterialSnackbar.cleanup_();return}a.MaterialSnackbar.showSnackbar({message:b.substring(2)})}function toggle(a){a.paused?a.play():a.pause()}window.addEventListener("load",function(){var c=document.getElementById("myvideo");var a=document.getElementById("url");var b=document.getElementById("channel");var d=window.location.origin+"/channel/"+cookie;b.href=d;b.text=d;a.onkeydown=function(e){if(e.which==13){webSocket.send("play-url,"+this.value);this.value="";document.getElementById("url-container").MaterialTextfield.checkDirty()}};document.addEventListener("keypress",function(e){if(e.which==32&&document.activeElement!==a){toggle(c)}});c.addEventListener("play",function(){webSocket.send("play")});c.addEventListener("pause",function(){webSocket.send("pause")});c.addEventListener("seeked",function(){webSocket.send("seek,"+this.currentTime)})});