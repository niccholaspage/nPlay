var cookie=document.cookie.substr(document.cookie.indexOf("=")+1);var webSocket=new WebSocket("ws://"+location.hostname+":"+location.port+"/play-status");webSocket.onopen=function(a){webSocket.send("channel,"+cookie)};webSocket.onmessage=function(c){var e=JSON.parse(c.data);var b=document.getElementById("myvideo");if(b.src!==e.url){b.src=e.url}var d=Math.abs(b.currentTime-e.seconds);if(d>1){b.currentTime=e.seconds}if(e.playing&&b.paused){b.currentTime=e.seconds;b.play()}else{if(!e.playing&&!b.paused){b.currentTime=e.seconds;b.pause()}}var a=document.getElementById("status");if(e.status.length!=0){a.style.visibility="visible";a.setAttribute("class","alert alert-success");a.textContent=e.status;a.style.visibility="visible"}else{a.style.visibility="hidden"}};webSocket.onclose=function(){var a=document.getElementById("status");a.style.visibility="visible";a.setAttribute("class","alert alert-danger");a.textContent="WebSocket closed! This is Luke's fault. Try refreshing the page."};function toggle(a){a.paused?a.play():a.pause()}window.addEventListener("load",function(){var c=document.getElementById("myvideo");var a=document.getElementById("url");var b=document.getElementById("channel");var d=window.location.origin+"/channel/"+cookie;b.href=d;b.text=d;a.onkeydown=function(e){if(e.which==13){webSocket.send("play-url,"+this.value);this.value=""}};document.addEventListener("keypress",function(e){if(e.which==32&&document.activeElement!==a){toggle(c)}});c.addEventListener("play",function(){webSocket.send("play")});c.addEventListener("pause",function(){webSocket.send("pause")});c.addEventListener("seeked",function(){webSocket.send("seek,"+this.currentTime)})});